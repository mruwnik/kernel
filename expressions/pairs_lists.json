{
  "description": "Pairs and lists test expressions",
  "tests": [
    {"expr": "(pair? (cons 1 2))", "expected": "#t"},
    {"expr": "(pair? ())", "expected": "#f"},
    {"expr": "(pair? 42)", "expected": "#f"},
    {"expr": "(pair? #t)", "expected": "#f"},
    {"expr": "(pair? (list 1))", "expected": "#t"},
    {"expr": "(pair? (list 1 2 3))", "expected": "#t"},
    {"expr": "(pair? #inert)", "expected": "#f"},
    {"expr": "(pair? #ignore)", "expected": "#f"},

    {"expr": "(null? ())", "expected": "#t"},
    {"expr": "(null? (cons 1 2))", "expected": "#f"},
    {"expr": "(null? 42)", "expected": "#f"},
    {"expr": "(null? #t)", "expected": "#f"},
    {"expr": "(null? (list))", "expected": "#t"},
    {"expr": "(null? (list 1))", "expected": "#f"},
    {"expr": "(null? (cdr (list 1)))", "expected": "#t"},

    {"expr": "(cons 1 2)", "expected": "(1 . 2)"},
    {"expr": "(cons 1 ())", "expected": "(1)"},
    {"expr": "(cons 1 (cons 2 ()))", "expected": "(1 2)"},
    {"expr": "(cons 1 (cons 2 (cons 3 ())))", "expected": "(1 2 3)"},
    {"expr": "(cons () ())", "expected": "(())"},
    {"expr": "(cons (cons 1 2) 3)", "expected": "((1 . 2) . 3)"},
    {"expr": "(cons 1 (list 2 3))", "expected": "(1 2 3)"},
    {"expr": "(cons (list 1 2) (list 3 4))", "expected": "((1 2) 3 4)"},

    {"expr": "(list)", "expected": "()"},
    {"expr": "(list 1)", "expected": "(1)"},
    {"expr": "(list 1 2)", "expected": "(1 2)"},
    {"expr": "(list 1 2 3 4 5)", "expected": "(1 2 3 4 5)"},
    {"expr": "(list (+ 1 1) (+ 2 2))", "expected": "(2 4)"},
    {"expr": "(list ())", "expected": "(())"},
    {"expr": "(list (list 1 2) (list 3 4))", "expected": "((1 2) (3 4))"},
    {"expr": "(list #t #f)", "expected": "(#t #f)"},
    {"expr": "(list #inert)", "expected": "(#inert)"},

    {"expr": "(list* 1)", "expected": "1"},
    {"expr": "(list* ())", "expected": "()"},
    {"expr": "(list* (list 1 2))", "expected": "(1 2)"},
    {"expr": "(list* 1 2)", "expected": "(1 . 2)"},
    {"expr": "(list* 1 2 3)", "expected": "(1 2 . 3)"},
    {"expr": "(list* 1 2 3 ())", "expected": "(1 2 3)"},
    {"expr": "(list* 1 2 (list 3 4))", "expected": "(1 2 3 4)"},
    {"expr": "(list* (+ 1 1) (+ 2 2))", "expected": "(2 . 4)"},
    {"expr": "(list* 1 2 3 4 5 ())", "expected": "(1 2 3 4 5)"},

    {"expr": "(car (cons 1 2))", "expected": "1"},
    {"expr": "(cdr (cons 1 2))", "expected": "2"},
    {"expr": "(car (list 1 2 3))", "expected": "1"},
    {"expr": "(cdr (list 1 2 3))", "expected": "(2 3)"},
    {"expr": "(car (cons () 1))", "expected": "()"},
    {"expr": "(cdr (cons 1 ()))", "expected": "()"},
    {"expr": "(car (list (list 1 2)))", "expected": "(1 2)"},
    {"expr": "(cdr (list 1))", "expected": "()"},

    {"expr": "(cadr (list 1 2 3))", "expected": "2"},
    {"expr": "(caddr (list 1 2 3 4))", "expected": "3"},
    {"expr": "(caar (list (list 1 2) 3))", "expected": "1"},
    {"expr": "(cdar (list (list 1 2) 3))", "expected": "(2)"},
    {"expr": "(cadr (cons 1 (cons 2 3)))", "expected": "2"},
    {"expr": "(caar (cons (cons 1 2) 3))", "expected": "1"},

    {"expr": "(length ())", "expected": "0"},
    {"expr": "(length (list 1))", "expected": "1"},
    {"expr": "(length (list 1 2 3))", "expected": "3"},
    {"expr": "(length (list 1 2 3 4 5))", "expected": "5"},
    {"expr": "(length (list () () ()))", "expected": "3"},
    {"expr": "(length (list (list 1 2) (list 3 4)))", "expected": "2"},

    {"expr": "(list-ref (list 10 20 30 40) 0)", "expected": "10"},
    {"expr": "(list-ref (list 10 20 30 40) 1)", "expected": "20"},
    {"expr": "(list-ref (list 10 20 30 40) 3)", "expected": "40"},
    {"expr": "(list-ref (list (list 1 2) (list 3 4)) 0)", "expected": "(1 2)"},
    {"expr": "(list-ref (list #t #f #t) 1)", "expected": "#f"},

    {"expr": "(list-tail (list 1 2 3 4 5) 0)", "expected": "(1 2 3 4 5)"},
    {"expr": "(list-tail (list 1 2 3 4 5) 1)", "expected": "(2 3 4 5)"},
    {"expr": "(list-tail (list 1 2 3 4 5) 2)", "expected": "(3 4 5)"},
    {"expr": "(list-tail (list 1 2 3 4 5) 5)", "expected": "()"},
    {"expr": "(list-tail (list 1 2 3) 3)", "expected": "()"},
    {"expr": "(list-tail () 0)", "expected": "()"},
    {"expr": "(car (list-tail (list 10 20 30) 1))", "expected": "20"},

    {"expr": "(append)", "expected": "()"},
    {"expr": "(append ())", "expected": "()"},
    {"expr": "(append (list 1 2 3))", "expected": "(1 2 3)"},
    {"expr": "(append (list 1 2) (list 3 4))", "expected": "(1 2 3 4)"},
    {"expr": "(append () (list 1 2))", "expected": "(1 2)"},
    {"expr": "(append (list 1 2) ())", "expected": "(1 2)"},
    {"expr": "(append (list 1) (list 2) (list 3))", "expected": "(1 2 3)"},
    {"expr": "(append (list 1 2) (list 3 4) (list 5 6))", "expected": "(1 2 3 4 5 6)"},
    {"expr": "(append () () ())", "expected": "()"},
    {"expr": "(append (list (list 1)) (list (list 2)))", "expected": "((1) (2))"},

    {"expr": "(filter ($lambda (x) (>? x 0)) (list 1 2 3))", "expected": "(1 2 3)"},
    {"expr": "(filter ($lambda (x) (<? x 0)) (list 1 2 3))", "expected": "()"},
    {"expr": "(filter ($lambda (x) (>? x 2)) (list 1 2 3 4 5))", "expected": "(3 4 5)"},
    {"expr": "(filter ($lambda (x) (even? x)) (list 1 2 3 4 5 6))", "expected": "(2 4 6)"},
    {"expr": "(filter ($lambda (x) (odd? x)) (list 1 2 3 4 5 6))", "expected": "(1 3 5)"},
    {"expr": "(filter ($lambda (x) #t) ())", "expected": "()"},
    {"expr": "(filter ($lambda (x) #f) (list 1 2 3))", "expected": "()"},

    {"expr": "(assoc 1 (list (list 1 10) (list 2 20)))", "expected": "(1 10)"},
    {"expr": "(assoc 2 (list (list 1 10) (list 2 20) (list 3 30)))", "expected": "(2 20)"},
    {"expr": "(assoc 3 (list (list 1 10) (list 2 20) (list 3 30)))", "expected": "(3 30)"},
    {"expr": "(assoc 5 (list (list 1 10) (list 2 20)))", "expected": "()", "note": "Kernel spec: assoc returns nil when not found"},
    {"expr": "(assoc 1 ())", "expected": "()", "note": "Kernel spec: assoc returns nil when not found"},
    {"expr": "(assoc 1 (list (list 1 10) (list 1 20)))", "expected": "(1 10)"},
    {"expr": "(cadr (assoc 2 (list (list 1 10) (list 2 20))))", "expected": "20"},

    {"expr": "(member 2 (list 1 2 3))", "expected": "(2 3)"},
    {"expr": "(member 1 (list 1 2 3))", "expected": "(1 2 3)"},
    {"expr": "(member 3 (list 1 2 3))", "expected": "(3)"},
    {"expr": "(member 5 (list 1 2 3))", "expected": "#f"},
    {"expr": "(member 1 ())", "expected": "#f"},
    {"expr": "(member () (list 1 () 2))", "expected": "(() 2)"},
    {"expr": "(car (member 2 (list 1 2 3)))", "expected": "2"},

    {"expr": "(reduce (list 1 2 3 4 5) + 0)", "expected": "15"},
    {"expr": "(reduce (list 1 2 3 4 5) * 1)", "expected": "120"},
    {"expr": "(reduce () + 0)", "expected": "0"},
    {"expr": "(reduce () * 1)", "expected": "1"},
    {"expr": "(reduce (list 1 2 3) + 100)", "expected": "106"},
    {"expr": "(reduce (list 1 2 3) ($lambda (a b) (+ a b)) 0)", "expected": "6"},

    {"expr": "(length (append (list 1 2) (list 3 4 5)))", "expected": "5"},
    {"expr": "(car (cdr (cdr (list 1 2 3 4))))", "expected": "3"},
    {"expr": "(list-ref (list-tail (list 1 2 3 4 5) 2) 1)", "expected": "4"},
    {"expr": "(length (filter ($lambda (x) (>? x 2)) (list 1 2 3 4 5)))", "expected": "3"},
    {"expr": "(reduce (filter ($lambda (x) (even? x)) (list 1 2 3 4 5 6)) + 0)", "expected": "12"},
    {"expr": "(car (append (list 1) (list 2 3)))", "expected": "1"},
    {"expr": "(cdr (append (list 1) (list 2 3)))", "expected": "(2 3)"},
    {"expr": "(list* 0 (filter ($lambda (x) (>? x 0)) (list 1 2 3)))", "expected": "(0 1 2 3)"},

    {"expr": "(pair? (list* 1 2))", "expected": "#t"},
    {"expr": "(pair? (append (list 1) (list 2)))", "expected": "#t"},
    {"expr": "(null? (filter ($lambda (x) #f) (list 1 2 3)))", "expected": "#t"},
    {"expr": "(null? (cdr (list 1)))", "expected": "#t"},
    {"expr": "(pair? (cdr (list 1 2)))", "expected": "#t"},

    {"expr": "(cons #inert #inert)", "expected": "(#inert . #inert)"},
    {"expr": "(cons #ignore #ignore)", "expected": "(#ignore . #ignore)"},
    {"expr": "(list #t #f #inert #ignore ())", "expected": "(#t #f #inert #ignore ())"},
    {"expr": "(car (cons (cons (cons 1 2) 3) 4))", "expected": "((1 . 2) . 3)"},
    {"expr": "(cdr (cdr (cdr (list 1 2 3))))", "expected": "()"},
    {"expr": "(append (list 1) (cons 2 3))", "expected": "(1 2 . 3)"},

    {"expr": "(map ($lambda (x) (* x 2)) (list 1 2 3))", "expected": "(2 4 6)"},
    {"expr": "(map ($lambda (x) (+ x 1)) (list 10 20 30))", "expected": "(11 21 31)"},
    {"expr": "(map ($lambda (x) x) (list 1 2 3))", "expected": "(1 2 3)"},
    {"expr": "(map ($lambda (x) x) ())", "expected": "()"},
    {"expr": "(map + (list 1 2 3) (list 10 20 30))", "expected": "(11 22 33)"},
    {"expr": "(map ($lambda (x) (list x x)) (list 1 2 3))", "expected": "((1 1) (2 2) (3 3))"},

    {"expr": "(reverse ())", "expected": "()"},
    {"expr": "(reverse (list 1))", "expected": "(1)"},
    {"expr": "(reverse (list 1 2 3))", "expected": "(3 2 1)"},
    {"expr": "(reverse (list 1 2 3 4 5))", "expected": "(5 4 3 2 1)"},
    {"expr": "(reverse (reverse (list 1 2 3)))", "expected": "(1 2 3)"},
    {"expr": "(car (reverse (list 1 2 3)))", "expected": "3"}
  ]
}
